<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="">
<head><meta name="generator" content="Hexo 3.8.0">
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT">










<meta property="og:type" content="website">
<meta property="og:title" content="CSNLPå­¦å¾’">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="CSNLPå­¦å¾’">
<meta property="og:locale" content="default">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="CSNLPå­¦å¾’">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/">





  <title>CSNLPå­¦å¾’</title><!-- hexo-inject:begin --><!-- hexo-inject:end -->
  








</head>

<body itemscope="" itemtype="http://schema.org/WebPage" lang="default">

  
  
    
  

  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope="" itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">CSNLPå­¦å¾’</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            Archives
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/11/01/HELLO/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="CSNLP Apprentice">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="CSNLPå­¦å¾’">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/11/01/HELLO/" itemprop="url">äººå·¥ç½®é¡¶</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-11-01T13:12:45+08:00">
                2019-11-01
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>å¼€è¿™ä¸ªåšå®¢ä¸»è¦è®°å½•ä¸€äº›NLPé¢†åŸŸæœ€æ–°çš„è¿›å±•ï¼Œå¦‚æœè¯»è€…æœ‹å‹æ„Ÿè§‰å†™ä½œçš„å†…å®¹æœ‰ä¸å¦¥ä¹‹å¤„æˆ–è€…ä¾µå®³äº†æ‚¨çš„ç‰ˆæƒï¼Œè¯·éšæ—¶è”ç³»æˆ‘, æˆ‘çœ‹åˆ°åä¼šç¬¬ä¸€æ—¶é—´å¤„ç†ï¼Œè”ç³»é‚®ç®±: csnlp16 AT 126.com. ååˆ†æ„Ÿè°¢ã€‚</p>
<p>This blog is to document the progress in NLP field. If you have any question about the content or you find this site infringes your copyright, please feal ease to contact me immediately,I will be the first time related to treatment. I will be found in: csnlp16 AT 126.com. Thanks a lot.</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/11/04/BERT/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="CSNLP Apprentice">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="CSNLPå­¦å¾’">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/11/04/BERT/" itemprop="url">BERTçš„å‘å±•å†ç¨‹</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-11-04T09:52:20+08:00">
                2018-11-04
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>æœ€è¿‘çœ‹åˆ°BERTæ¨¡å‹å„ä¸ªå…¬ä¼—å·éƒ½åœ¨æ¨é€ï¼Œä½†æ˜¯å¯¹äºBERTçš„è§£è¯»èµ„æ–™ç›®å‰ç¨æ˜¾ä¸è¶³ï¼Œè€Œä¸”BERTçš„å‘å±•å†ç¨‹ç›®å‰ç¼ºä¹ä¸€ä¸ªè¯¦ç»†çš„è§£é‡Šï¼Œæˆ‘è¿™é‡ŒæŠ›ç –å¼•ç‰ï¼Œæ€»ç»“ä¸€ä¸‹BERTç›¸å…³çš„è®ºæ–‡ï¼Œæƒå½“åšä¸ªç¬”è®°ã€‚</p>
<h2 id="BERTçš„Background"><a href="#BERTçš„Background" class="headerlink" title="BERTçš„Background"></a>BERTçš„Background</h2><h3 id="BERTæ˜¯ç”¨æ¥åšä»€ä¹ˆå‘¢ï¼Ÿ"><a href="#BERTæ˜¯ç”¨æ¥åšä»€ä¹ˆå‘¢ï¼Ÿ" class="headerlink" title="BERTæ˜¯ç”¨æ¥åšä»€ä¹ˆå‘¢ï¼Ÿ"></a>BERTæ˜¯ç”¨æ¥åšä»€ä¹ˆå‘¢ï¼Ÿ</h3><p>è°·æ­Œçš„ç›®æ ‡æ˜¯æœŸå¾…èƒ½å¤Ÿæ‰“é€ å›¾åƒé¢†åŸŸçš„ImageNet, æˆ‘ä»¬çŸ¥é“ç°åœ¨CVé¢†åŸŸçš„ä¸€äº›ä»»åŠ¡éƒ½ä¸€èˆ¬ä¸æ˜¯ä»é›¶å¼€å§‹ï¼Œè€Œæ˜¯åœ¨ImageNetè¿™äº›é¢„è®­ç»ƒå¥½çš„æ¨¡å‹ä¸Šå¾®è°ƒã€‚ä½†æ˜¯NLPä¸Šå°šæœªæœ‰è¿™æ ·å…¬è®¤çš„ImageNetçš„å­˜åœ¨ã€‚è¿™é‡Œå†™ä¸€ä¸‹NLPå¦‚æœé‡‡ç”¨ImageNetè¿™æ ·çš„å½¢å¼å®ƒçš„upper-stream task å’Œ down-stream task æ˜¯ä»€ä¹ˆ</p>
<table>
<thead>
<tr>
<th style="text-align:left">task</th>
<th style="text-align:left">æ•°æ®</th>
<th style="text-align:left">ç›®æ ‡</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">upper-stream task</td>
<td style="text-align:left">éå¸¸å¤§çš„è¯­æ–™ï¼Œç†è®ºä¸Šè¶Šå¤§è¶Šå¥½</td>
<td style="text-align:left">å¾—åˆ°ä¸€ä¸ªgeneral, good, robust çš„è¯­è¨€è¡¨ç¤º</td>
</tr>
<tr>
<td style="text-align:left">down-stream task</td>
<td style="text-align:left">å°±æ˜¯ç‰¹å®šä»»åŠ¡çš„è¯­æ–™</td>
<td style="text-align:left">è§£å†³ç‰¹å®štask, è­¬å¦‚sentiment analysis, question answering</td>
</tr>
</tbody>
</table>
<p>BERT ç›®æ ‡æ˜¯å¤„ç†down-stream task, i.e.,å¾—åˆ°ä¸€ä¸ªè¯­è¨€è¡¨ç¤ºæ¨¡å‹(language representation model), æˆ–è€…è¯´æ˜¯ â€œpre-trained language representationsâ€ã€‚ ä»è¿™ä¸ªæ„ä¹‰ä¸Šæ¥è®²ï¼Œæˆ‘ä»¬ä¹‹å‰ç”¨çš„Word2Vec æˆ–è€… GloVe å…¶å®ä¹Ÿæ˜¯é¢„å…ˆè®­ç»ƒå¥½çš„â€WORD-LEVELâ€çš„è¡¨è¾¾ã€‚ç›®å‰ï¼Œå°†pre-trained language representations åº”ç”¨åˆ°ä¸‹æ¸¸ä»»åŠ¡(down stream task)ä¸­æœ‰ä¸¤ç§æ–¹å¼, </p>
<ul>
<li>feature-based<br>feature-based å…¸å‹ä»£è¡¨æœ‰ELMo (2018å¹´NAACL Best Paper),å°†è¿™äº› representationä½œä¸ºæ–°çš„featuresåŠ å…¥åˆ° task-speacific architectureä¸­</li>
<li>fine-tunning<br>å…¸å‹ä»£è¡¨: OpenAI GPTã€‚ç›´æ¥åœ¨é¢„è®­ç»ƒå¥½çš„æ¨¡å‹ä¸Šåˆ©ç”¨ task-specific æ•°æ®fine tune</li>
</ul>
<h3 id="ä¸ºä»€ä¹ˆä¼šå‡ºç°BERT"><a href="#ä¸ºä»€ä¹ˆä¼šå‡ºç°BERT" class="headerlink" title="ä¸ºä»€ä¹ˆä¼šå‡ºç°BERT"></a>ä¸ºä»€ä¹ˆä¼šå‡ºç°BERT</h3><ul>
<li>åœ¨Word2Vecå’ŒGloVeä¸­ï¼Œä¸€ä¸ªè¯æ— è®ºåœ¨ä»»ä½•è¯­å¢ƒä¸‹éƒ½æ˜¯ä¸€ä¸ªå‘é‡ï¼Œæ˜¾ç„¶è¿™ä¸æ˜¯å®Œç¾çš„ã€‚â€œæ¸©æš–çš„ é˜³å…‰ ç…§å°„åœ¨ æˆ‘èº«ä¸Šâ€ â€œä»–çš„ è¯ å¾ˆ æ¸©æš–â€ï¼Œæ˜¾ç„¶è¿™é‡Œçš„â€œæ¸©æš–â€ å¦‚æœæ˜¯ä¸€ä¸ªå‘é‡æ¥è¡¨ç¤ºæ˜¾ç„¶ä¸å¤ªç²¾ç¡®ï¼Œæˆ‘ä»¬æœŸå¾…ä¸€ä¸ªå‘é‡èƒ½å¤Ÿèå…¥ä¸Šä¸‹æ–‡ä¿¡æ¯(Context), ELMo æŠ“ä½äº†è¿™ä¸€ç—›ç‚¹ï¼Œæå‡ºäº†ä¸€ç§æ–°çš„Word Embedding æ–¹æ³•ã€‚</li>
<li>å°½ç®¡ELMoå‡ºç°äº†ï¼Œä½†æ˜¯å…¶å‡ºç°ä»ç„¶æ˜¯å¸Œæœ›èƒ½å¤Ÿä»£æ›¿Word2Vec,å­¦åˆ°ä¸€ä¸ªæ›´åŠ å…·æœ‰(context) ä¿¡æ¯çš„Word Embedding, ç„¶è€Œï¼Œå¯¹äºä¸€äº›å¤æ‚çš„ä»»åŠ¡ï¼Œæœ‰äº›é€»è¾‘æ›´å¤æ‚(dialogueä¹‹ç±»çš„)ï¼Œä¸€ä¸ªå¥½çš„Embedding å¯èƒ½è¿˜ä¸å¤Ÿã€‚</li>
<li>BERTå¸Œæœ›èƒ½å¤Ÿåœ¨é¢„è®­ç»ƒæ¨¡å‹ä¸Šå°±èƒ½æ•æ‰åˆ°å¾ˆå¤æ‚çš„å…³ç³»: ä¸Šä¸‹æ–‡é€»è¾‘ã€è¯­æ–™åœºæ™¯ç­‰</li>
</ul>
<h2 id="BERT-ä¹‹å‰éœ€è¦æœ‰çš„çŸ¥è¯†å‚¨å¤‡"><a href="#BERT-ä¹‹å‰éœ€è¦æœ‰çš„çŸ¥è¯†å‚¨å¤‡" class="headerlink" title="BERT ä¹‹å‰éœ€è¦æœ‰çš„çŸ¥è¯†å‚¨å¤‡"></a>BERT ä¹‹å‰éœ€è¦æœ‰çš„çŸ¥è¯†å‚¨å¤‡</h2><ul>
<li>LSTMåŸºæœ¬çŸ¥è¯†(æœ¬æ–‡ä¸è®²)</li>
<li>Attentionæœºåˆ¶çš„ç†è§£ (å‚è€ƒæˆ‘çš„ä¸“é—¨çš„åšå®¢<a href="https://csnlp.github.io/2018/11/03/Attention/" target="_blank" rel="noopener">Attentionæœºåˆ¶</a>)</li>
<li>Self-Attention: Self-Attention å°±æ˜¯BERTæåˆ°çš„Transformerï¼Œæ˜¯ç°åœ¨éå¸¸æµè¡Œçš„åŸºæœ¬ç»„ä»¶(Block), æœ€å¥½èƒ½ç†è§£çš„ååˆ†æ·±å…¥,è¿™é‡Œä¹Ÿå•ç‹¬å¼€ä¸€ä¸ªåšæ–‡<h2 id="è°·æ­Œé€‰æ‹©çš„æ–¹æ³•-BERT"><a href="#è°·æ­Œé€‰æ‹©çš„æ–¹æ³•-BERT" class="headerlink" title="è°·æ­Œé€‰æ‹©çš„æ–¹æ³•-BERT"></a>è°·æ­Œé€‰æ‹©çš„æ–¹æ³•-BERT</h2><h3 id="é¢„è®­ç»ƒæ¨¡å‹"><a href="#é¢„è®­ç»ƒæ¨¡å‹" class="headerlink" title="é¢„è®­ç»ƒæ¨¡å‹"></a>é¢„è®­ç»ƒæ¨¡å‹</h3>é¦–å…ˆBERTé€‰æ‹©äº†fine-tuneçš„æ€è·¯,ä¹Ÿå°±æ˜¯é€šè¿‡åšupper-stream taskæ¥pre-trainä¸€ä¸ªæ¨¡å‹, ç„¶åå¾®è°ƒã€‚ç›®å‰å­¦æœ¯ç•Œåœ¨upper-stream è¿™ä¸ªä»»åŠ¡ä¸Šï¼Œä¹Ÿå°±æ˜¯åœ¨å­¦general language representationæ—¶å€™ï¼Œéƒ½é€‰æ‹©<strong>Unidirectional Language Model</strong>, åŸå› åœ¨äºè¿™ç§å•å‘çš„ç»“æ„åœ¨è¿›è¡Œé¢„è®­ç»ƒæ—¶å€™ï¼Œåªèƒ½åœ¨å½“å‰ä½ç½®ä¹‹å‰çš„è¯æ±‡ä¸­åšSelf-Attentionæ“ä½œ <blockquote><p>The major limitation is that standard language models are unidirectional, and this limits the choice of architectures that can be used during pre-training. For example, in OpenAI GPT, the authors use a left-to-right architecture, where every token can only attend to previous tokens in the self-attention layers of the Transformer.  </p>
</blockquote><br>BERTä¸ç”¨Unidirectional Language Model è€Œé‡‡ç”¨å…¨æ–°çš„ä»»åŠ¡ <strong>Masked Language Model</strong>, å…¶å®å°±æ˜¯è‹±æ–‡è€ƒè¯•å¸¸è€ƒçš„ â€œCloze Task(å®Œå½¢å¡«ç©º)â€ã€‚è¿™ä¸ªæ€æ ·ç†è§£: è­¬å¦‚BERTæƒ³è¦å¾—åˆ°ä¸€ä¸ªNLPèƒ½åŠ›å¾ˆå¼ºçš„é¢„è®­ç»ƒæ¨¡å‹ï¼Œ<strong>å®Œå½¢å¡«ç©ºç›¸å½“äºæ²¡ä¸€ä¸ªç©ºæ ¼éƒ½éœ€è¦ä½ å»é è‡ªå·±çš„NLPèƒ½åŠ›å»è¡¥å……ä¸Šå»</strong>ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹æ•´ä¸ªè¯­æ–™åº“éšæœºé®ä½ 15% çš„tokensï¼Œè¿™äº›è¢«é®ä½çš„éƒ¨åˆ†è®°ä¸º[MASK], ç„¶åå»å°†è¿™äº›[MASK] é‡æ–°é¢„æµ‹ä¸ºçœŸå®è¯è¯­ã€‚ä½†æ˜¯è¿™æ ·ä¹Ÿå­˜åœ¨é—®é¢˜</li>
</ul>
<ul>
<li>Pre-train å’Œ fine-tune é˜¶æ®µç›®æ ‡å‡½æ•°ä¸ä¸€è‡´<br>æ¯•ç«Ÿåœ¨Pre-trainæ—¶å€™ï¼Œå­˜åœ¨[MASK], è€Œåœ¨fine-tune é˜¶æ®µçœŸå®NLPä»»åŠ¡ä¸­æ˜¯æ²¡æœ‰[MASK] å­˜åœ¨çš„<br>è§£å†³æ–¹æ¡ˆ:<ul>
<li>80% çš„æƒ…å†µä¸‹é€‰æ‹©çš„è¯è¯­å°±æ˜¯æ›¿æ¢æˆ[MASK] E.g.: A cat is walking.â€“&gt; A cat [MASK] walking.</li>
<li>10% çš„æƒ…å†µä¸‹: é€‰æ‹©çš„è¯è¯­éšæœºæ›¿æ¢æˆä¸€ä¸ªè¯è¯­  E.g&gt;: A cat is walking â€“&gt; A cat good walking.</li>
<li>10 çš„æƒ…å†µä¸‹: é€‰æ‹©çš„è¯è¯­è¿˜æ˜¯æ›¿æ¢æˆåŸæ¥çš„è¯è¯­ E.g., A cat is walking â€“&gt; A cat is walking. </li>
</ul>
</li>
</ul>
<p>åˆ†æä¸€ä¸‹ï¼Œè¿™é‡Œåœ¨åšä»€ä¹ˆ<blockquote><p>The Transformer encoder does not konw which words it will be asked to predict or which have been replaced by random words, so it is forced to keep a distributional contextual representation of every input token</p>
</blockquote></p>
<ul>
<li>å› ä¸ºåªæœ‰15% çš„token è¢«é¢„æµ‹ï¼Œè€Œåœ¨Unidirectional Language Model ä¸­æ‰€æœ‰çš„tokenéƒ½ä¼šè¢«é¢„æµ‹ï¼Œæ˜¾ç„¶Masked Language Modelæ•ˆç‡æ˜¯å¾ˆä½çš„ã€‚</li>
</ul>
<h3 id="BERTçš„è®­ç»ƒæ–¹æ³•"><a href="#BERTçš„è®­ç»ƒæ–¹æ³•" class="headerlink" title="BERTçš„è®­ç»ƒæ–¹æ³•"></a>BERTçš„è®­ç»ƒæ–¹æ³•</h3><p>ä¸ºäº†æ–¹ä¾¿ç†è§£: æˆ‘ä» Input, Output, Model Structure, Loss Function æ¥è®²è¿™ä¸ªé—®é¢˜ã€‚</p>
<ul>
<li>Input<br><img src="BERT_input.jpg" alt=""></li>
</ul>
<ul>
<li>Token Embedding: å°±æ˜¯æœ€å¸¸è§çš„Word Embedding, æ³¨æ„[CLS]æ˜¯æŒ‡çš„ä¸€ä¸ªåˆ†ç±»æ ‡ç­¾ï¼Œæ˜¯ä¸ºäº†åˆ†ç±»ä»»åŠ¡å­˜åœ¨çš„</li>
<li>Segment Embedding: é’ˆå¯¹ä¸€äº›å¯¹è¯è¯­æ–™ Aä»£è¡¨ç¬¬ä¸€å¥ï¼ŒBä»£è¡¨ç¬¬äºŒå¥</li>
<li>Position Embedding: å› ä¸ºBERTæ˜¯åŸºäºTransformerå»ºç«‹çš„,è€ŒTransformerä¸åƒRNNï¼Œ Transformeræ˜¯æ²¡æœ‰ä½ç½®ä¿¡æ¯çš„ï¼Œå› æ­¤éœ€è¦Position Embedding æ¥é¢å¤–çš„è¡¨ç¤ºä½ç½®ä¿¡æ¯</li>
</ul>
<p>æœ€åInputå°±æ˜¯ï¼š $\text{Input} = \text{Token Embedding} + \text{Segment Embedding} + \text{Position Embedding}$</p>
<ul>
<li>Output<br>è­¬å¦‚æˆ‘ä»¬çš„Inputæ˜¯â€œMy dog is cute, he likes play leaves.â€ æˆ‘ä»¬æŒ–ç©ºäº† â€œcuteâ€, ä¹Ÿå°±æ˜¯å°†â€cuteâ€æ›¿æ¢æˆäº†â€MASKâ€, é‚£ä¹ˆç°åœ¨æˆ‘ä»¬Transformerçš„Inputå°±æ˜¯ â€œMy dog is [MASK], he likes playâ€outputå°±æ˜¯ â€œcuteâ€</li>
</ul>
<h3 id="down-strem-ä»»åŠ¡å¦‚ä½•æ¥å…¥ï¼Ÿ"><a href="#down-strem-ä»»åŠ¡å¦‚ä½•æ¥å…¥ï¼Ÿ" class="headerlink" title="down-strem ä»»åŠ¡å¦‚ä½•æ¥å…¥ï¼Ÿ"></a>down-strem ä»»åŠ¡å¦‚ä½•æ¥å…¥ï¼Ÿ</h3><h2 id="æ€»çš„æƒ³æ³•"><a href="#æ€»çš„æƒ³æ³•" class="headerlink" title="æ€»çš„æƒ³æ³•"></a>æ€»çš„æƒ³æ³•</h2><p>å°±æ˜¯å¾ˆå¤šNLPä¸Šçš„ä»»åŠ¡å¯ä»¥é‡æ–°æ€è€ƒä¸€ä¸‹ï¼Œè°·æ­Œå…¶å®åœ¨é¿å…ä¸€ç§å€¾å‘,è¿™ç§å€¾å‘æ˜¯<br><blockquote><p>NLPçš„å„ä¸ªä»»åŠ¡è¶Šæ¥è¶Šä¸“ï¼Œé’ˆå¯¹ç‰¹å®šä»»åŠ¡è®¾è®¡çš„æ¨¡å‹è¶Šæ¥è¶Šå¤æ‚ï¼Œç½‘ç»œå±‚æ•°è¶Šæ¥è¶Šæ·±ï¼Œå„ç§Attention</p>
</blockquote></p>
<p>æˆ‘è¿™é‡Œæ²¡æœ‰èµ„æ ¼è¯„ä»·è¿™ç§å€¾å‘å¥½æˆ–è€…ä¸å¥½ã€‚ä½†æ˜¯è°·æ­Œå°±æ˜¯åå…¶é“è€Œè¡Œï¼Œè¯æ˜äº†<br><blockquote><p>æˆ‘è¿™é‡Œæ­å»ºä¸€ä¸ªååˆ†Generalçš„åŸºç¡€<strong>BERT</strong>ï¼Œåœ¨BERTçš„åŸºç¡€ä¸Šï¼Œé’ˆå¯¹ç‰¹å®šä»»åŠ¡ï¼Œä¸€ä¸ªå¾ˆç®€å•çš„å°ä¿®å°è¡¥å°±è¶³ä»¥è§£å†³é—®é¢˜</p>
</blockquote><br>å½“ç„¶ï¼Œè°·æ­Œä¹Ÿå‡ºäº†å¾ˆå¤šåœ¨ç‰¹å®šä»»åŠ¡ä¸Šååˆ†impressive çš„workã€‚ã€‚<br>è°·æ­Œçš„æ¨¡å‹ï¼Œè¶Šæ¥è¶Šè¯æ˜äº§ä¸šç•Œçš„å­¦æœ¯æ½œåŠ›ï¼Œäº§ä¸šç•Œå¤§æ‰‹ç¬”ï¼Œå¤§è®¡ç®—èƒ½åŠ›ï¼Œå¤§èµ„æºï¼Œæœæ°”!!!</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/11/02/hello-world/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="CSNLP Apprentice">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="CSNLPå­¦å¾’">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/11/02/hello-world/" itemprop="url">Hello World</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-11-02T21:22:27+08:00">
                2018-11-02
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Welcome to <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="noopener">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="noopener">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="noopener">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">"My New Post"</span></span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="noopener">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="noopener">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="noopener">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/deployment.html" target="_blank" rel="noopener">Deployment</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/11/02/Transformer/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="CSNLP Apprentice">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="CSNLPå­¦å¾’">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/11/02/Transformer/" itemprop="url">Transformer</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-11-02T10:35:36+08:00">
                2018-11-02
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>æœ¬æ–‡å…¶å®å†™çš„æœ‰äº›è¿Ÿåˆ°ï¼Œæ¯•ç«Ÿè¿™æ˜¯è°·æ­Œ17å¹´6æœˆçš„å·¥ä½œï¼Œä¸è¿‡å¥½æˆä¸æ€•æ™šï¼Œè¿™é¡¹å·¥ä½œäº®ç‚¹åœ¨äºä¸ç”¨CNN,RNNä¹Ÿèƒ½å¾—åˆ°STOAçš„æ•ˆæœ, è€Œç†è®ºä¸Šçš„æŒ‡å¯¼æ„ä¹‰åœ¨äº</p>
<ul>
<li>Self-Attentionæ€æƒ³</li>
<li>Transformer ç»“æ„</li>
</ul>
<p>è¿™é‡Œæ¨¡å‹ç»“æ„å¼ºæ¨å¦ä¸€ä¸ªåšå®¢ï¼Œè®²çš„ååˆ†æ¸…æ¥šï¼ŒæŒ‰ç…§æ•°æ®çš„å¤„ç†æµç¨‹æ¥è®²ï¼Œååˆ†æ¸…æ¥šã€‚<br><a href="https://nlppupil.github.io/%E8%87%AA%E7%84%B6%E8%AF%AD%E8%A8%80%E5%A4%84%E7%90%86/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/2018/06/09/Attention-is-all-you-need-%E8%A7%A3%E8%AF%BB.html" title="Transformer" target="_blank" rel="noopener">Transformer</a><br>å…¶å®Transformer è¿˜æ˜¯ä¸€ä¸ªSeq2Seq çš„ç»“æ„ï¼Œä½†æ˜¯Transformer å´æ‰“ç ´äº†ä¸€ç§è§‚ç‚¹ï¼ŒSeq2Seq ä¸€å®šæ˜¯åŸºäºRNNï¼ŒLSTM æ¥è¿›è¡Œçš„ã€‚</p>
<h2 id="Encoder-éƒ¨åˆ†"><a href="#Encoder-éƒ¨åˆ†" class="headerlink" title="Encoder éƒ¨åˆ†"></a>Encoder éƒ¨åˆ†</h2><p>Encoderçš„ç»„ä»¶</p>
<ul>
<li>Multi-Head Attention ç»„ä»¶</li>
<li>Feed-Forward ç»„ä»¶</li>
</ul>
<p>æˆ‘è¿™é‡Œç”¨ç»„ä»¶ï¼Œæ˜¯å› ä¸ºæ¯ä¸€ä¸ªMulti-Head Attention &amp; Feed-Forward æ“ä½œä¹‹åéƒ½ä¼šç´§è·Ÿ</p>
<ul>
<li>residual connection</li>
<li>layer normalization<br>è¿™é‡Œå¯¹è¿™äº›æ“ä½œæ”¾åœ¨ä»‹ç»å®ŒMulti-Head Attention å’Œ Feed-Forwardä¹‹åè°ˆ</li>
</ul>
<h3 id="Multi-Head-Attentionç»„ä»¶"><a href="#Multi-Head-Attentionç»„ä»¶" class="headerlink" title="Multi-Head Attentionç»„ä»¶"></a>Multi-Head Attentionç»„ä»¶</h3><p><img src="transformer_encoder_selfattention.jpg" alt=""><br>åæ˜ åˆ°å…¬å¼ä¸Š<br>$$\text{MultiHead}(Q, K, V) = \text{Concat}(head_1, \dots, head_h)W^{O}$$<br>where   $$\text{head}_i = \text{Attention}(QW_i^Q, KW_i^K, VW_i^V)$$   $$\text{Attention}(Q, K, V) = \text{softmax}(\frac{QK^T}{\sqrt{d_v}})V$$<br>å…¶ä¸­ å¯¹äºSelf-Attentionæ¥è®²$K = Q = K \in R^{d_{model}}$ ,$W_i^Q \in R^{d_{model} \times d_k}$, $W_i^K \in R^{d_{model} \times d_k}$, $W_i^V \in R^{d_{model} \times d_V}$</p>
<p>è¿™ä¹ˆåšçš„Motivationæ˜¯ä»€ä¹ˆ<br><blockquote><p>Instead of performing a single attention fuction with $d_{model}$ dimensional keys, values and queries, we found it benefical to linearly project the queries, keys and values h times with different learned linear projects to $d_k, d_k$ and $d_v$ dimensions respectively. </p>
</blockquote></p>
<h3 id="Feed-Forwardç»„ä»¶"><a href="#Feed-Forwardç»„ä»¶" class="headerlink" title="Feed-Forwardç»„ä»¶"></a>Feed-Forwardç»„ä»¶</h3><p>æ¯ä¸€ä¸ªMulti-Head Attentionä¹‹åéƒ½ä¼šç´§è·ŸFeed-Forwardç»„ä»¶, Feed-Forward ç›¸å¯¹ç®€å•,åªæœ‰ä¸¤å±‚ï¼Œç¬¬ä¸€å±‚ååŠ äº†ä¸€ä¸ªReLU. ç”¨å…¬å¼è¡¨ç¤º:  $$FFN(x) = max(0, xW_1 + b_1) W_2 + b_2$$ å…¶ä¸­ $x \in R^{lenght \times d_{model}}, W_1 \in R^{d_{model} \times d_m}, W_2 \in R^{d_m \times d_{model}}$</p>
<h3 id="Residual-Connection-amp-Layer-Normalization"><a href="#Residual-Connection-amp-Layer-Normalization" class="headerlink" title="Residual Connection &amp; Layer Normalization"></a>Residual Connection &amp; Layer Normalization</h3><p>åº–ä¸è§£ç‰›è¿™é‡Œè®²æ¸…æ¥šè¿™ä¸¤ä¸ªæ“ä½œ</p>
<ul>
<li>Residual Connection<br>æ˜¯é’ˆå¯¹ä¸€ä¸ªç½‘ç»œå‡½æ•°æ¥è®²ï¼Œæˆ‘ä»¬å‡å®šè¿™ä¸ªç½‘ç»œçš„è¾“å…¥ä¸ºx,è¾“å‡ºä¸ºLayer(x), é‚£ä¹ˆResidual Connectionå¯¹äºè¿™ä¸ªLayerçš„æ“ä½œå°±æ˜¯$$Residual(x) = x + Layer(x)$$ï¼Œ æ®‹å·®ç½‘ç»œæ˜¯ä¸ºäº†è®©æ·±å±‚ç½‘ç»œæ¢¯åº¦æ›´æ˜“ä¼ æ’­ï¼Œå¯ä»¥ç†è§£ä¸ºä¸ºäº†è®­ç»ƒæ–¹ä¾¿é‡‡å–çš„ç­–ç•¥(è¿™é‡Œæˆ‘çš„ç†è§£ä¸ä¸€å®šæ·±å…¥ï¼Œå¸Œæœ›åŒé“èƒ½æŒ‡å‡º)</li>
<li>Layer Normalization<br>è¿™ä¸ªä¹Ÿæ˜¯ä¸ºäº†è®©è®­ç»ƒç¨³å®šé‡‡å–çš„ç­–ç•¥ï¼Œè¿™é‡ŒNormalizationçš„ç­–ç•¥å¾ˆå¤šBatch Normalization, Layer Normalizationç­‰,è½å®åˆ°ä»£ç ä¸Šå¯èƒ½å°±æ˜¯ä¸€ä¸ªè°ƒç”¨åº“çš„æ“ä½œ $LayerNorm(x)$ æœ€åç»è¿‡Residual Connectionå’Œ Layer Normalizationå¾—åˆ°çš„æ“ä½œå°±æ˜¯<br>$$\text{LayerNorm}(x + SubLayer(x))$$</li>
</ul>
<p>ä¸€ä¸ªMulth-Head Attentionç»„ä»¶ å’Œ ä¸€ä¸ªFeed-Forwardç»„ä»¶ ç»„æˆä¸€ä¸ªLayer, è€Œå¤šä¸ªLayer ç»„æˆäº†Encoderã€‚(Encoder is composed of a stack of N=6 identical layers)<br>åœ¨è¿™é‡Œæˆ‘ä»¬æ‹ä¸€ä¸‹è¾“å…¥å’Œè¾“å‡º: å¯¹äºLayer çš„è¾“å…¥å…¶ç»´åº¦ä¸º $R^{\text{length} \times {d_{model}}}$, è€Œç»è¿‡ (Multi-Head Attention, Feed-Forward) ä»ç„¶æ˜¯$R^{\text{length} \times {d_{model}}}$ã€‚</p>
<h3 id="å…³äºPosition-Embedding"><a href="#å…³äºPosition-Embedding" class="headerlink" title="å…³äºPosition Embedding"></a>å…³äºPosition Embedding</h3><p><em>Attention Is All You Need</em> çš„å¾ˆå¤§çš„äº®ç‚¹åœ¨äºæ²¡ç”¨RNNçš„ç»“æ„ï¼Œä½†æ˜¯å¯¹äºè¯­è¨€è¿™æ ·çš„åºåˆ—æ•°æ®ï¼ŒPositionä¿¡æ¯è¿˜æ˜¯å¾ˆé‡è¦çš„ï¼Œä¸ºæ­¤éœ€è¦äººä¸ºçš„å¼•å…¥Position Embeddingä¿¡æ¯ï¼ŒåŸæ–‡ç›´æ¥å°±ç»™äº†å…¬å¼ï¼Œæˆ‘è¯´ä¸ä¸Šæ¥è¿™æ˜¯æ€ä¹ˆå¾—åˆ°,è¿™é‡Œä»…ä»…è®°å½•ä¸€ä¸‹æœ‰è¿™ä¸ªPosition Embedding <img src="transformer_position_embedding.jpg" alt=""> </p>
<p>åŸºæœ¬ä¸Šåˆ°è¿™é‡Œï¼Œå¯¹Encoderçš„ç»“æ„åº”è¯¥å¾ˆç†Ÿæ‚‰ï¼Œå‚è§ä¸‹å›¾<img src="transformer_encoder.jpg" alt="" title="Transformer Encoderç»“æ„"> æˆ‘è¿™é‡Œæœ€åä»ä¸‹åˆ°ä¸Šæ‹ä¸€é: Inputè¿›æ¥ï¼Œå…ˆè¿›è¡Œè¯åµŒå…¥(Input Embedding), ç„¶ååŠ å…¥ä½ç½®ä¿¡æ¯(Position Embedding), è€Œåè¿›å…¥Self-Attentionæ¨¡å—(Multi-Head Attention), æ³¨æ„å›¾ä¸­çš„<em>Add &amp; Norm</em> å…¶å®ä¹Ÿå°±æ˜¯æŒ‡çš„<strong>Residual &amp; Layer Normalization</strong>. å®Œæˆäº†Self Attention ä¹‹åè®°ä½æ­¤æ—¶è¾“å‡ºä»ç„¶å’ŒåŸæ¥è¾“å…¥ç»´åº¦æ˜¯ä¸€æ ·çš„ä»ç„¶æ˜¯$R^{d_{model}}$ã€‚ æ¥ä¸‹æ¥å°±æ˜¯Feed-Forward ç»„ä»¶ï¼ŒåŒæ ·çš„ Add &amp; Normalizationä¸€æ ·å°±æ˜¯ <strong>Residual &amp; Layer Normalization</strong>ã€‚è¿™æ—¶å€™è¾“å‡ºä»ç„¶æ˜¯ä¸è¾“å…¥ç»´åº¦æ˜¯ä¸€æ ·çš„ã€‚å¦‚æœæŠŠä¸Šè¿°æ‰€æœ‰æ“ä½œçœ‹æˆä¸€ä¸ªBig Layer, è¿™äº›Big Layer å åŠ å¤šæ¬¡(è°·æ­Œè®ºæ–‡æ˜¯å åŠ äº†6æ¬¡ï¼Œå°±å¾—åˆ°äº†Encoderç»“æ„)</p>
<h2 id="Decoderçš„ç»“æ„"><a href="#Decoderçš„ç»“æ„" class="headerlink" title="Decoderçš„ç»“æ„"></a>Decoderçš„ç»“æ„</h2><p>æœ‰äº†å‰é¢Encoderçš„è®²è§£ï¼Œåç»­ç›¸å¯¹ç®€å•,ä¸ºäº†ä¾¿äºç†è§£æˆ‘è´´ä¸€å¼ Transformerçš„æ•´ä½“ç»“æ„å›¾<img src="transformer_structure.jpg" alt="" title="Transformer Structure"> å…ˆæ˜¯Self-Attentionï¼Œ ç„¶åæ˜¯Encoder-Decoder Attention(å…¶å®ä¹Ÿå°±æ˜¯ä¼ ç»Ÿçš„Seq2Seqä¸­çš„Attention æœºåˆ¶ï¼Œå¯ä»¥å‚è€ƒæˆ‘ä¹‹å‰çš„åšæ–‡<a href="https://csnlp.github.io/2018/11/03/Attention/" title="Attentionæœºåˆ¶" target="_blank" rel="noopener">Attentionæœºåˆ¶</a><br>æˆ‘ä»¬ä¸å¦¨ğŸ¤”ä¸€ä¸‹ï¼šè¿™ä¸ªæµç¨‹æ˜¯æ€æ ·çš„ï¼Œé‚£æœºå™¨ç¿»è¯‘ä¸¾ä¾‹â€I like eating applesâ€, ç¿»è¯‘â€œæˆ‘ å–œæ¬¢ åƒ è‹¹æœâ€ï¼Œé—®é¢˜æ¥äº†åœ¨Encoderä¸­ï¼Œ â€œlikeâ€ æ³¨æ„åˆ° (attends to)â€Iâ€ â€œeatingâ€ å›ºç„¶æ²¡æœ‰é—®é¢˜,æ¯•ç«Ÿè¾“å…¥è¯­æ–™éƒ½ä¸€ä¸‹å­ç»™åˆ°Encoder, like åŒæ—¶æ³¨æ„åˆ°ä¸Šæ–‡çš„ â€œIâ€ å’Œ ä¸‹æ–‡çš„â€œeatingâ€, â€œapplesâ€ è¿™æ˜¾ç„¶æ˜¯å¥½äº‹ï¼Œè¿™æ ·Attendså¾—åˆ°çš„like æ˜¾ç„¶æ›´åŠ æœ‰é‡ç‚¹ã€‚ ç„¶è€Œï¼Œå¯¹äºdecoder æ¥è®²ï¼Œå¦‚æœä» start è¦ç¿»è¯‘å¾—åˆ°â€œæˆ‘â€ï¼Œè€ŒåŒæ—¶æ³¨æ„åˆ°æ¥ä¸‹æ¥æ˜¯â€æˆ‘â€ â€œå–œæ¬¢â€ â€œåƒâ€ â€œè‹¹æœâ€, é‚£ä¹ˆç¿»è¯‘â€œæˆ‘â€æ—¶ï¼Œç›´æ¥ä»ä¸‹ä¸€ä¸ªåºåˆ—æ‹¿ä¸‹æ¥ç¬¬ä¸€ä¸ªâ€œæˆ‘â€ å³å¯ï¼ŒåŒç†ï¼Œç¿»è¯‘â€œå–œæ¬¢â€æ—¶å€™(æ³¨æ„è¿™æ—¶å€™æ˜¯decoderè¾“å‡ºäº†â€œæˆ‘â€)ï¼Œæ³¨æ„åˆ°æ¥ä¸‹æ¥æ˜¯â€å–œæ¬¢â€ï¼Œé‚£ä¹ˆç›´æ¥copy å°±è¡Œäº†ï¼Œæ ¹æœ¬å°±ä¸éœ€è¦è®­ç»ƒäº†ã€‚çœ‹èµ·æ¥è²Œä¼¼è¯´çš„é€šï¼Œä½†æ˜¯è®­ç»ƒçš„æ¨¡å‹æ˜¯ä¸ºäº†è§£å†³ä»»åŠ¡ï¼Œå½“è®­ç»ƒå®Œæˆåï¼Œç»™äº†ä¸€ä¸ªsource è¯­å¥ï¼Œæ­¤æ—¶æ²¡æœ‰target è¯­å¥ï¼Œæ˜¾ç„¶è¿™æ—¶å€™æ¨¡å‹å°±æ²¡æœ‰åŠæ³•äº†ã€‚å› æ­¤ï¼Œæœ‰ä»¥ä¸‹æ³¨æ„ç‚¹ &lt;%centerquote%&gt; decoderçš„Self-Attentionç»„ä»¶ä¸encoderä¸­çš„ä¸åŒï¼Œdecoderä¸­çš„Self-Attentionåªèƒ½æ³¨æ„åˆ°(attends) å½“å‰output ä¹‹å‰çš„ä½ç½®çš„outputä¿¡æ¯&lt;%centerquote%&gt;  ä¹Ÿå°±æ˜¯è­¬å¦‚â€œæˆ‘â€ â€œå–œæ¬¢â€ï¼Œæ¥ä¸‹æ¥ç¿»è¯‘â€œåƒâ€ï¼Œè¾“å…¥æ˜¯â€œå–œæ¬¢â€ &amp; â€œæˆ‘â€çš„Self-Attentionã€‚  </p>
<p>é™¤æ­¤ä¹‹å¤–,Decoderå…¶å®æœ‰ä¸¤ç§Attention</p>
<ul>
<li>Self-Attention</li>
<li>Encoder-Decoder Attention</li>
</ul>
<p>å¯ä»¥ç€é‡ç†è§£ä¸€ä¸‹ï¼Œè‡³äºK, V, Q çš„å…·ä½“å«ä¹‰ï¼Œå¯ä»¥å‚è€ƒæˆ‘ä¹‹å‰çš„åšæ–‡<a href="https://csnlp.github.io/2018/11/03/Attention/" title="Attentionæ³›åŒ–" target="_blank" rel="noopener">Attentionçš„æ³›åŒ–</a></p>
<h2 id="Loss-Function"><a href="#Loss-Function" class="headerlink" title="Loss Function"></a>Loss Function</h2><p>å¯¹äºä¸¤ä¸ªæ¦‚ç‡åˆ†å¸ƒçš„Loss Functionï¼Œ æ—¢å¯ä»¥ç”¨Cross-Entropy ä¹Ÿå¯ä»¥ç”¨ Kullback-Leibler Divergenceã€‚å¯¹äºæ¦‚ç‡åˆ†å¸ƒpå’Œæ¦‚ç‡åˆ†å¸ƒqè€Œè¨€ï¼Œä»–ä»¬çš„Cross-Entropyå¯ä»¥å®šä¹‰ä¸º $$CE_p(q) = -E[ q(x) \log(p(x))]$$</p>
<h2 id="å¯¹ç°æœ‰å·¥ä½œçš„å¯å‘"><a href="#å¯¹ç°æœ‰å·¥ä½œçš„å¯å‘" class="headerlink" title="å¯¹ç°æœ‰å·¥ä½œçš„å¯å‘"></a>å¯¹ç°æœ‰å·¥ä½œçš„å¯å‘</h2><p>ç°åœ¨Transformer å·²ç»ä½œä¸ºTensorflowçš„ä¸€ä¸ªæ¨¡å—ä¸Šçº¿äº† <a href="https://github.com/tensorflow/tensor2tensor" title="Tensor2Tensor" target="_blank" rel="noopener">Tensor2Tensor</a>ã€‚è€ŒAttentionä¹Ÿçº¢ç«äº†ä¸€æ®µæ—¶é—´ï¼Œå°¤å…¶æ˜¯æå‡ºçš„Self-Attentionæ€æƒ³ï¼Œå¯èƒ½æ˜¯ç›¸æ¯”äºæ¨¡å‹ç»“æ„æ›´åŠ èƒ½å¼•äººæ€è€ƒä¹‹å¤„ã€‚</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/11/01/Attention/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="CSNLP Apprentice">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="CSNLPå­¦å¾’">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/11/01/Attention/" itemprop="url">Attentionæœºåˆ¶</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-11-01T10:35:20+08:00">
                2018-11-01
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>å¦‚æœæŒ‰ç…§æ—¶é—´é¡ºåºæ¥è®²ï¼Œè°·æ­Œçš„Seq2Seqä¹‹åå¦ä¸€ä¸ªéå¸¸å¤§çš„è¿›å±•å°±æ˜¯Attentionæœºåˆ¶äº†ï¼Œä¸€æ—¶é—´å„ç§Attentionå±‚å‡ºä¸ç©·ï¼Œè¿™é‡Œæˆ‘æŒ‰ç…§è‡ªå·±çš„ç†è§£å†™ä¸€å†™Attention æœºåˆ¶ã€‚é™¤æ­¤ä¹‹å¤–ï¼ŒAttentionä¹Ÿæ˜¯å¦å¤–ä¸€ä¸ªé‡å¤§çªç ´:Transformerçš„åŸºç¡€ï¼Œå¸Œæœ›å¤§å®¶èƒ½å¤Ÿè®¤çœŸç†è§£ç²¾é«“ã€‚</p>
<h1 id="Attentionçš„Motivation"><a href="#Attentionçš„Motivation" class="headerlink" title="Attentionçš„Motivation"></a>Attentionçš„Motivation</h1><p>åœ¨Seq2Seqæ¨¡å‹æå‡ºä¹‹åï¼ŒMachine Translationæ€§èƒ½å¾—åˆ°äº†ä¸€ä¸ªé£è·ƒï¼ŒNMTä¹Ÿè¢«è®¤ä¸ºæ˜¯MTçš„åŸºæœ¬æ–¹æ³•ï¼Œä¸€åˆ‡çœ‹èµ·æ¥éƒ½å¾ˆç¾å¥½ï¼Œä½†æ˜¯é—®é¢˜ä»ç„¶å­˜åœ¨:<br>åˆ¶çº¦ç“¶é¢ˆ(Bottleneck): encoder çš„æœ€åä¸€ä¸ªéšå‘é‡çš„è¡¨ç¤ºæ€§èƒ½<br>å‚åŠ ä¸‹å›¾: å›¾ç‰‡æ¥è‡ªäºStanford CS224N lecture 10 slides<br><img src="bottleneck.jpg" alt=""><br>ç”±æ­¤å¯è§ï¼ŒEncoderçš„æœ€åä¸€ä¸ªéšå‘é‡éœ€è¦è¡¨è¾¾çš„ä¿¡æ¯é‡å¾ˆå¤§ï¼Œåç»­Decoderçš„decodeè¿‡ç¨‹éƒ½ä¸¥é‡ä¾èµ–äºè¿™ä¸€ä¸ªéšå‘é‡ã€‚è€Œæ‹¿Machine Translation ä¸¾ä¾‹:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">I like eating oranges . </span><br><span class="line">æˆ‘ å–œæ¬¢ åƒ æ¡”å­ ã€‚</span><br></pre></td></tr></table></figure></p>
<p>æ˜¾ç„¶ï¼Œ åœ¨ç¿»è¯‘æ—¶ï¼Œâ€œæˆ‘â€ éœ€è¦æ›´å¤šå…³æ³¨â€œIâ€ï¼Œ â€œåƒâ€ éœ€è¦æ›´å¤šå…³æ³¨â€œeatingâ€ã€‚è¿™ä¸ªmotivation å°±å¯å‘äº†Attention çš„è¯ç”Ÿã€‚ </p>
<h1 id="Seq2Seqæ¨¡å‹ä¸­Attentionçš„å…·ä½“å®ç°"><a href="#Seq2Seqæ¨¡å‹ä¸­Attentionçš„å…·ä½“å®ç°" class="headerlink" title="Seq2Seqæ¨¡å‹ä¸­Attentionçš„å…·ä½“å®ç°"></a>Seq2Seqæ¨¡å‹ä¸­Attentionçš„å…·ä½“å®ç°</h1><p>æ”¾ä¸€å¼ Stanford CS224N lecture 10 slides å¯¹äºAttentionçš„ç†è§£ï¼Œå¾ˆæ¸…æ™°<br><img src="attention_mechanism.jpg" alt="attention mechanism first units" title="Attention Mechanism"><br>å¯¹è¿™ä¸ªå›¾çš„è§£è¯»å¦‚ä¸‹,ä»ä¸‹å¾€ä¸Š</p>
<ol>
<li>RNN(LSTM,GRU) ç»„æˆçš„Encoderçš„hidden state: $e_1, \dots, e_N \in R^h$</li>
<li>On timestep $t$, decoderçš„hidden state æ˜¯$d_t$</li>
<li>Attention Scoreçš„è®¡ç®—:<br>$$s^t = d^T_t \cdot e_1, d^T_t \cdot e_2, \dots, d^T_t \cdot e_N$$</li>
<li>æœ‰Attentions score è½¬åŒ–ä¸ºattention distribution:<br>$$\alpha^t = softmax(s^t) \in R^N$$</li>
<li>Attentionçš„è¾“å‡º<br>$$o^t = \sum_{i=1}^{N} \alpha^t_i h_i \in R^h$$</li>
<li>Attentionçš„è¾“å‡ºä¸Decoder çš„éšçŠ¶æ€æ‹¼æ¥$$[o^t; d^t] \in R^{2h}$$ å¾—åˆ°å‘é‡ä¸$U$($U \in R^{\vert V \vert * 2h}$)è¿›è¡Œçº¿æ€§ç½‘ç»œå±‚,åç»­åœ¨è¿›è¡ŒSoftmaxå¾—åˆ°åœ¨æ•´ä¸ªè¯å…¸ä¸Šçš„æ¦‚ç‡åˆ†å¸ƒ. å…¶å®åç»­éƒ½æ˜¯å’ŒSeq2Seq ä¸­çš„RNN ç»“æ„æ˜¯ä¸€æ ·çš„ï¼Œåªæ˜¯ç°åœ¨$U$ æ‰©å¤§äº†ï¼Œè€Œä¸”ç°åœ¨Decoderçš„RNNçš„ä¸‹ä¸€ä¸ªåºåˆ—æ˜¯ç”±å½“å‰éšçŠ¶æ€å’Œä¸€ä¸ªattentionè¾“å‡ºæ‹¼æ¥è€Œæˆçš„ã€‚<br><img src="RNN_LM.jpg" alt="RNN LM" title="RNN Language Model"> </li>
</ol>
<h1 id="Attentionçš„æ³›åŒ–"><a href="#Attentionçš„æ³›åŒ–" class="headerlink" title="Attentionçš„æ³›åŒ–"></a>Attentionçš„æ³›åŒ–</h1><p>è¿™é‡Œä¹‹æ‰€ä»¥è®²Attentionçš„æ³›åŒ–åœ¨äºä¼šæå¤§çš„ä¿ƒè¿›å¯¹<em>Attention Is All You Need</em> ä¹Ÿå°±æ˜¯Transformerçš„ç†è§£ã€‚<br>è¿™é‡Œå…ˆå¼•ç”¨æ‘˜è‡ª<em>Attention Is All You Need</em> çš„è®ºæ–‡ä¸€æ®µè®ºè¿°:<br><blockquote><p>An attention function can be described as mapping a query and a set of key-value pairs to an output, where the query, keys, values, and output are all vectors. The output is computed as a weighted sum of the values, where the weight assigned to each value is computed by a compatibility function of the query with the corresponding key.</p>
</blockquote></p>
<p>$$Attention(Q,K,V) = softmax(QK^T)V$$</p>
<p>è¿™é‡Œåˆ—å‡ºå„ä¸ªé¡¹ç»´åº¦</p>
<ul>
<li>$Q$: ä»£è¡¨query, $Q \in R^{1 * d_{KQ}}$ </li>
<li>$K$: ä»£è¡¨key, $K \in R^{N * d_{KQ}}$ </li>
<li>$V$: ä»£è¡¨value, $V \in R^{N * d_v}$ </li>
</ul>
<p>åœ¨Seq2Seqçš„Attention ä¸­, queryä¸ºdecoderçš„éšçŠ¶æ€$d^t$, keyä¸ºencoderçš„å„ä¸ªéšå‘é‡ï¼ŒvalueåŒkeyä¹Ÿæ˜¯encoderçš„å„ä¸ªéšå‘é‡ã€‚</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  


          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">CSNLP Apprentice</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">5</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            

            
              
              
              <div class="site-state-item site-state-tags">
                
                  <span class="site-state-item-count">1</span>
                  <span class="site-state-item-name">tags</span>
                
              </div>
            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">CSNLP Apprentice</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script><!-- hexo-inject:begin --><!-- hexo-inject:end -->
  


  

  

</body>
</html>
